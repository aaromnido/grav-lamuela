<h1 id="grav-simplesearch-plugin">Grav SimpleSearch Plugin</h1>
<p><img src="assets/readme_1.png" alt="SimpleSearch"></p>
<p><code>SimpleSearch</code> is a simple, yet very powerful <a href="http://github.com/getgrav/grav">Grav</a> plugin that adds search capabilities to your Grav instance. By default it can search Page <strong>Titles</strong>, <strong>Content</strong> and also <strong>Taxonomy</strong>.</p>
<h1 id="installation">Installation</h1>
<p>Installing the SimpleSearch plugin can be done in one of two ways. Our GPM (Grav Package Manager) installation method enables you to quickly and easily install the plugin with a simple terminal command, while the manual method enables you to do so via a zip file.</p>
<h2 id="gpm-installation-preferred-">GPM Installation (Preferred)</h2>
<p>The simplest way to install this plugin is via the <a href="http://learn.getgrav.org/advanced/grav-gpm">Grav Package Manager (GPM)</a> through your system&#39;s Terminal (also called the command line).  From the root of your Grav install type:</p>
<pre><code>bin/gpm install simplesearch
</code></pre><p>This will install the SimpleSearch plugin into your <code>/user/plugins</code> directory within Grav. Its files can be found under <code>/your/site/grav/user/plugins/simplesearch</code>.</p>
<h2 id="manual-installation">Manual Installation</h2>
<p>To install this plugin, just download the zip version of this repository and unzip it under <code>/your/site/grav/user/plugins</code>. Then, rename the folder to <code>simplesearch</code>. You can find these files either on <a href="https://github.com/getgrav/grav-plugin-simplesearch">GitHub</a> or via <a href="http://getgrav.org/downloads/plugins#extras">GetGrav.org</a>.</p>
<p>You should now have all the plugin files under</p>
<pre><code>/your/site/grav/user/plugins/simplesearch
</code></pre><blockquote>
<p>NOTE: This plugin is a modular component for Grav which requires <a href="http://github.com/getgrav/grav">Grav</a>, the <a href="https://github.com/getgrav/grav-plugin-error">Error</a> and <a href="https://github.com/getgrav/grav-plugin-problems">Problems</a> plugins, and a theme to be installed in order to operate.</p>
</blockquote>
<h1 id="config-options">Config Options</h1>
<p>To effectively use the plugin, you first need to create an override config. To do so, create the folder <code>user/config/plugins</code> (if it doesn&#39;t exist already) and copy the <a href="simplesearch.yaml">simplesearch.yaml</a> config file in there.</p>
<pre><code>enabled: true
built_in_css: true
display_button: false
min_query_length: 3
route: /search
template: simplesearch_results
filters:
    category: blog
filter_combinator: and
order:
    by: date
    dir: desc
</code></pre><p>By creating the configuration file: <code>user/config/plugins/simplesearch.yaml</code> you have effectively created a site-wide configuration for SimpleSearch.  However, you may want to have multiple searches.  </p>
<blockquote>
<p>NOTE: If you want to search <strong>ALL PAGES</strong> just keep the <code>filters</code> section empty.</p>
</blockquote>
<p>To accomplish multiple search types in a single site, you should use <strong>page-based</strong> configuration. This is simple to do, simply provide any or all of the configuration options under a <code>simplesearch:</code> header in your page frontmatter.  For example:</p>
<pre><code>simplesearch:
    route: @self
    filters:
        - @self
        - @taxonomy: [tag]
    filter_combinator: and
</code></pre><p> These page headers will only be taken into account if the search route points to this page.  For example: here the the route points to <code>@self</code> which in turn resolves to <code>/blog</code>.  You can also specify the route explicity with <code>route: /blog</code> if you so choose. This header is within the <code>/user/pages/blog/blog.md</code> file.  We will cover this self-controlled form of search handling below.</p>
<h1 id="usage">Usage</h1>
<p>There are two approaches to using SimpleSearch.  </p>
<h2 id="1-standalone-search-page">1. Standalone Search Page</h2>
<p>This is the traditional approach and involves having a searchbox &#39;somewhere&#39; on your site. When you search you are shown a new page that displays the search results.  On this page you will see a summary of the results and be able to click a link to visit each applicable page within your site.  Think about how <strong>Google</strong> and other traditional search engines work.</p>
<p>After installing the SimpleSearch plugin, you can add a simple <strong>searchbox</strong> to your site by including the provided twig template.  Or copy it from the plugin to your theme and customize it as you please:</p>
<pre><code>{% include &#39;partials/simplesearch_searchbox.html.twig&#39; %}
</code></pre><p>By default the <strong>simplesearch_searchbox</strong> Twig template uses the <code>route</code> as defined in the configuration.  The SimpleSearch plugin uses this route and then appends a <code>query:</code> paramater to create the following final URL.</p>
<pre><code>http://yoursite.com/search/query:something
</code></pre><ol>
<li><code>/search</code>: This is the <strong>route</strong> setting and it can be changed</li>
<li><code>/query:something</code>: This is the query itself, where <code>something</code> is what you are searching for.</li>
</ol>
<p>The plugin actively looks for URLs requested that match the configured <code>route</code> and if so it intercepts the call and renders the results template as specified by the configuration options, (defaults to <code>simplesearch_results.html.twig</code> as provided by the plugin). </p>
<p>With this approach, the filters control which pages are searched.  You can have multiple taxonomy filters here, and can configure the combinator to require <strong>any</strong> match (via <code>or</code>) or require <strong>all</strong> conditions to match (via <code>and</code>).</p>
<p>You can also completely customize the look and feel of the results by overriding the template. There are two methods to do this.</p>
<ol>
<li><p>Copy the file <a href="templates/simplesearch_results.html.twig">templates/simplesearch_results.html.twig</a> under your theme templates <code>user/themes/_your-theme_/templates/</code> and customize it.</p>
</li>
<li><p>Create your very own results output. For this you need to change the <code>template</code> reference in the config (let&#39;s say <strong>mysearch_results</strong>). In your theme you would then create the new template under <code>user/themes/_your-theme_/templates/mysearch_results.html.twig</code> and write your customizations. This is how it looks by default:</p>
<pre><code> {% extends &#39;partials/simplesearch_base.html.twig&#39; %}

 {% block content %}
     &lt;div class=&quot;content-padding&quot;&gt;
     &lt;h1 class=&quot;search-header&quot;&gt;Search Results&lt;/h1&gt;
     &lt;h3&gt;Query: &quot;{{ query }}&quot; - Found {{ search_results.count }} {{ &#39;Item&#39;|pluralize(search_results.count) }}&lt;/h3&gt;

     {% for page in search_results %}
         {% include &#39;partials/simplesearch_item.html.twig&#39; with {&#39;page&#39;:page} %}
     {% endfor %}
     &lt;/div&gt;
 {% endblock %}
</code></pre></li>
</ol>
<h2 id="2-self-controlled-search-page">2. Self-Controlled Search Page</h2>
<p>This is a new feature of SimpleSearch and it very useful and simple way to provide a &#39;filter&#39; like search of a collection listing page.  In this example, we will assume you have a Blog listing page you wish to be able to search and filter based on a search box.</p>
<p>To accomplish this, you need ot use the page-based configuration as described above, and configure multiple filters, <code>@self</code> to use the page&#39;s content collection: <a href="http://learn.getgrav.org/content/headers#collection-headers">http://learn.getgrav.org/content/headers#collection-headers</a></p>
<pre><code>content:
    items: @self.children
    order:
        by: date
        dir: desc
</code></pre><p>This will mean the search will only search pages that this page already is using for the collection.  The Items could be anything the page collections support: </p>
<p>For further help with the <code>filters</code> and <code>order</code> settings, please refer to our <a href="http://learn.getgrav.org/content/taxonomy">Taxonomy</a> and <a href="http://learn.getgrav.org/content/headers">Headers</a> documentation.</p>
<p>Multiple filters can be provided, and in order to search in the page&#39;s <strong>Tag</strong> field you would add <code>- @taxonomy: [tag]</code> as shown in the configuration example above.</p>
<p>The only thing needed to provide this functionality is a search box that points to the current page and appends the <code>query</code> parameter.  You can again simple include the sample <code>simplesearch_searchbox.html.twig</code> file or add your own. Because the route is configured to point to the blog page, and because the blog page already iterates over a collection, SimpleSearch will replace the page collection with the search-filtered collection.  No results page is required.</p>
<h2 id="searching-taxonomy">Searching Taxonomy</h2>
<p>By default <strong>SimpleSearch</strong> will search in the <strong>Title</strong>, <strong>Content</strong>, and <strong>Taxonomy</strong>.  All taxonomy will be searched unless you provide a <strong>taxonomy filter</strong> either in the page, or in the global plugin configuration:</p>
<pre><code>filters:
    - @taxonomy: [tag]
</code></pre><p>This will ensure that only <strong>tag</strong> taxonomy types will be searched for the query.</p>
<pre><code>filters:
    - @taxonomy: [tag, author]
</code></pre><p>Will ensure that both <strong>tag</strong> and <strong>author</strong> taxonomy types are searched.</p>
<p>As <strong>all taxonomy sis searched by default</strong>, in order to stop searching of taxonomy completely simply set the filter to false:</p>
<pre><code>filters:
    - &#39;@taxonomy&#39;: false
</code></pre><h1 id="updating">Updating</h1>
<p>As development for SimpleSearch continues, new versions may become available that add additional features and functionality, improve compatibility with newer Grav releases, and generally provide a better user experience. Updating SimpleSearch is easy, and can be done through Grav&#39;s GPM system, as well as manually.</p>
<h2 id="gpm-update-preferred-">GPM Update (Preferred)</h2>
<p>The simplest way to update this plugin is via the <a href="http://learn.getgrav.org/advanced/grav-gpm">Grav Package Manager (GPM)</a>. You can do this with this by navigating to the root directory of your Grav install using your system&#39;s Terminal (also called command line) and typing the following:</p>
<pre><code>bin/gpm update simplesearch
</code></pre><p>This command will check your Grav install to see if your SimpleSearch plugin is due for an update. If a newer release is found, you will be asked whether or not you wish to update. To continue, type <code>y</code> and hit enter. The plugin will automatically update and clear Grav&#39;s cache.</p>
<blockquote>
<p>Note: Any changes you have made to any of the files listed under this directory will also be removed and replaced by the new set. Any files located elsewhere (for example a YAML settings file placed in <code>user/config/plugins</code>) will remain intact.</p>
</blockquote>
